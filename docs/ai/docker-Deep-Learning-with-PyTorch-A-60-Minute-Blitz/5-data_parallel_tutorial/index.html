<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Scott Tech Demos Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Scott Tech Demos Blog Atom Feed"><title data-react-helmet="true">5-data_parallel_tutorial | Scott Tech Demos</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="5-data_parallel_tutorial | Scott Tech Demos"><meta data-react-helmet="true" name="description" content="`python"><meta data-react-helmet="true" property="og:description" content="`python"><meta data-react-helmet="true" property="og:url" content="https://scottapp.github.io//docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/5-data_parallel_tutorial"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scottapp.github.io//docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/5-data_parallel_tutorial"><link rel="stylesheet" href="/styles.412d942f.css">
<link rel="preload" href="/styles.158d0914.js" as="script">
<link rel="preload" href="/runtime~main.964a54e4.js" as="script">
<link rel="preload" href="/main.bb327f68.js" as="script">
<link rel="preload" href="/1.3e61523c.js" as="script">
<link rel="preload" href="/59.154e425e.js" as="script">
<link rel="preload" href="/60.a806e59f.js" as="script">
<link rel="preload" href="/935f2afb.0712ab80.js" as="script">
<link rel="preload" href="/58.60bc48f2.js" as="script">
<link rel="preload" href="/552d6cc9.feb4921c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Scott Tech Demos</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Quantitative Trading</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz">AI</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/google_cloud/google-cloud-swagger-helloworld">Google Cloud</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scottapp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Scott Tech Demos</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Quantitative Trading</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz">AI</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/google_cloud/google-cloud-swagger-helloworld">Google Cloud</a></li><li class="menu__list-item"><a href="https://github.com/scottapp" target="_blank" rel="noopener noreferrer" class="menu__link">My GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Pytorch Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">60 minutes Blitz</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz">60 minutes Blitz</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/1-tensor_tutorial">1-tensor_tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/2-autograd_tutorial">2-autograd_tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/3-neural_networks_tutorial">3-neural_networks_tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/4-cifar10_tutorial">4-cifar10_tutorial</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/5-data_parallel_tutorial">5-data_parallel_tutorial</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Pytorch Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial">Pytorch Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/201_torch_numpy">201 Torch and Numpy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/202_variable">202 Variable</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/203_activation">203 Activation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/301_regression">301 Regression</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/302_classification">302 Classification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/303_build_nn_quickly">303 Build NN Quickly</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/304_save_reload">304 Save and Reload</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/305_batch_train">305 Batch Train</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/306_optimizer">206 Optimizers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/401_CNN">401 CNN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/402_RNN">402 RNN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/403_RNN_regressor">403 RNN Regressor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/404_autoencoder">404 Autoencoder</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/405_DQN_Reinforcement_learning">405 DQN Reinforcement Learning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/406_GAN">406 GAN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/501_why_torch_dynamic_graph">501 Why Torch Dynamic Graph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/502_GPU">502 GPU</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/503_dropout">503 Dropout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/Docker-PyTorch-Tutorial/504_batch_normalization">504 Batch Normalization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">What is Torch NN</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/What-is-Torch-nn">What is Torch NN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/What-is-Torch-nn/nn_tutorial">nn_tutorial</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">5-data_parallel_tutorial</h1></header><div class="markdown"><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain">matplotlib inline</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="optional-data-parallelism"></a>Optional: Data Parallelism<a class="hash-link" href="#optional-data-parallelism" title="Direct link to heading">#</a></h1><p><strong>Authors</strong>: <code>Sung Kim &lt;https://github.com/hunkim&gt;</code><em> and <code>Jenny Kang &lt;https://github.com/jennykang&gt;</code></em></p><p>In this tutorial, we will learn how to use multiple GPUs using <code>DataParallel</code>.</p><p>It&#x27;s very easy to use GPUs with PyTorch. You can put the model on a GPU:</p><p>.. code:: python</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">device = torch.device(&quot;cuda:0&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">model.to(device)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Then, you can copy all your tensors to the GPU:</p><p>.. code:: python</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mytensor = my_tensor.to(device)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Please note that just calling <code>my_tensor.to(device)</code> returns a new copy of
<code>my_tensor</code> on GPU instead of rewriting <code>my_tensor</code>. You need to assign it to
a new tensor and use that tensor on the GPU.</p><p>It&#x27;s natural to execute your forward, backward propagations on multiple GPUs.
However, Pytorch will only use one GPU by default. You can easily run your
operations on multiple GPUs by making your model run parallelly using
<code>DataParallel</code>:</p><p>.. code:: python</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">model = nn.DataParallel(model)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>That&#x27;s the core behind this tutorial. We will explore it in more detail below.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="imports-and-parameters"></a>Imports and parameters<a class="hash-link" href="#imports-and-parameters" title="Direct link to heading">#</a></h2><p>Import PyTorch modules and define parameters.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torch</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> nn</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> DataLoader</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Parameters and DataLoaders</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">input_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">output_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">batch_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">data_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Device</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">device </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cuda:0&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cuda</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">is_available</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cpu&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dummy-dataset"></a>Dummy DataSet<a class="hash-link" href="#dummy-dataset" title="Direct link to heading">#</a></h2><p>Make a dummy (random) dataset. You just need to implement the
getitem</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">RandomDataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> length</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">randn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__getitem__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__len__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rand_loader </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> DataLoader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dataset</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">RandomDataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">input_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                         batch_size</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> shuffle</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="simple-model"></a>Simple Model<a class="hash-link" href="#simple-model" title="Direct link to heading">#</a></h2><p>For the demo, our model just gets an input, performs a linear operation, and
gives an output. However, you can use <code>DataParallel</code> on any model (CNN, RNN,
Capsule Net etc.)</p><p>We&#x27;ve placed a print statement inside the model to monitor the size of input
and output tensors.
Please pay attention to what is printed at batch rank 0.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Our model</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> input_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> output_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Linear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">input_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> output_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">forward</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        output </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;\tIn Model: input size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;output size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> output</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> output</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-model-and-dataparallel"></a>Create Model and DataParallel<a class="hash-link" href="#create-model-and-dataparallel" title="Direct link to heading">#</a></h2><p>This is the core part of the tutorial. First, we need to make a model instance
and check if we have multiple GPUs. If we have multiple GPUs, we can wrap
our model using <code>nn.DataParallel</code>. Then we can put our model on GPUs by
<code>model.to(device)</code></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">model </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">input_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> output_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cuda</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">device_count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Let&#x27;s use&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cuda</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">device_count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GPUs!&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># dim = 0 [30, xxx] -&gt; [10, ...], [10, ...], [10, ...] on 3 GPUs</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  model </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">DataParallel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Model(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (fc): Linear(in_features=5, out_features=2, bias=True)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="run-the-model"></a>Run the Model<a class="hash-link" href="#run-the-model" title="Direct link to heading">#</a></h2><p>Now we can see the sizes of input and output tensors.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> data </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> rand_loader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">input</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    output </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Outside: input size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;output_size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> output</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([30, 5]) output size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([30, 5]) output size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([30, 5]) output size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([10, 5]) output_size torch.Size([10, 2])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="results"></a>Results<a class="hash-link" href="#results" title="Direct link to heading">#</a></h2><p>If you have no GPU or one GPU, when we batch 30 inputs and 30 outputs, the model gets 30 and outputs 30 as
expected. But if you have multiple GPUs, then you can get results like this.</p><p>2 GPUs</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">If you have 2, you will see:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.. code:: bash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # on 2 GPUs</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Let&#x27;s use 2 GPUs!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([15, 5]) output size torch.Size([15, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([15, 5]) output size torch.Size([15, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([15, 5]) output size torch.Size([15, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([15, 5]) output size torch.Size([15, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([15, 5]) output size torch.Size([15, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([15, 5]) output size torch.Size([15, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([5, 5]) output size torch.Size([5, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([5, 5]) output size torch.Size([5, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([10, 5]) output_size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3 GPUs</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If you have 3 GPUs, you will see:</p><p>.. code:: bash</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Let&#x27;s use 3 GPUs!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([10, 5]) output size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Outside: input size torch.Size([10, 5]) output_size torch.Size([10, 2])</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>8 GPUs</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">If you have 8, you will see:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.. code:: bash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Let&#x27;s use 8 GPUs!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([4, 5]) output size torch.Size([4, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([30, 5]) output_size torch.Size([30, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        In Model: input size torch.Size([2, 5]) output size torch.Size([2, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Outside: input size torch.Size([10, 5]) output_size torch.Size([10, 2])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Summary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DataParallel splits your data automatically and sends job orders to multiple</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">models on several GPUs. After each model finishes their job, DataParallel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">collects and merges the results before returning it to you.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">For more information, please check out</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">https://pytorch.org/tutorials/beginner/former\_torchies/parallelism\_tutorial.html.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/4-cifar10_tutorial"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 4-cifar10_tutorial</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ai/Docker-PyTorch-Tutorial"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Pytorch Tutorial Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#imports-and-parameters" class="table-of-contents__link">Imports and parameters</a></li><li><a href="#dummy-dataset" class="table-of-contents__link">Dummy DataSet</a></li><li><a href="#simple-model" class="table-of-contents__link">Simple Model</a></li><li><a href="#create-model-and-dataparallel" class="table-of-contents__link">Create Model and DataParallel</a></li><li><a href="#run-the-model" class="table-of-contents__link">Run the Model</a></li><li><a href="#results" class="table-of-contents__link">Results</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/scottapp" target="_blank" rel="noopener noreferrer" class="footer__link-item">My Github</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.158d0914.js"></script>
<script src="/runtime~main.964a54e4.js"></script>
<script src="/main.bb327f68.js"></script>
<script src="/1.3e61523c.js"></script>
<script src="/59.154e425e.js"></script>
<script src="/60.a806e59f.js"></script>
<script src="/935f2afb.0712ab80.js"></script>
<script src="/58.60bc48f2.js"></script>
<script src="/552d6cc9.feb4921c.js"></script>
</body>
</html>