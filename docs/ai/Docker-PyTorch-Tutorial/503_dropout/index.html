<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Scott Tech Demos Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Scott Tech Demos Blog Atom Feed"><title data-react-helmet="true">503 Dropout | Scott Tech Demos</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="503 Dropout | Scott Tech Demos"><meta data-react-helmet="true" name="description" content="View more, visit my tutorial page//mofanpy.com/tutorials/"><meta data-react-helmet="true" property="og:description" content="View more, visit my tutorial page//mofanpy.com/tutorials/"><meta data-react-helmet="true" property="og:url" content="https://scottapp.github.io//docs/ai/Docker-PyTorch-Tutorial/503_dropout"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scottapp.github.io//docs/ai/Docker-PyTorch-Tutorial/503_dropout"><link rel="stylesheet" href="/styles.157dcc77.css">
<link rel="preload" href="/styles.17a13f5e.js" as="script">
<link rel="preload" href="/runtime~main.a6e9567d.js" as="script">
<link rel="preload" href="/main.f1fc0924.js" as="script">
<link rel="preload" href="/1.d92934f8.js" as="script">
<link rel="preload" href="/58.88e27d8d.js" as="script">
<link rel="preload" href="/59.9c53c36f.js" as="script">
<link rel="preload" href="/935f2afb.bed38aba.js" as="script">
<link rel="preload" href="/57.7e63f0fc.js" as="script">
<link rel="preload" href="/bea0d63e.7aa2a360.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Scott Tech Demos</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Quantitative Trading</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz">AI</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/google_cloud/google-cloud-swagger-helloworld">Google Cloud</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scottapp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">My GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="Scott Tech Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Scott Tech Demos</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Quantitative Trading</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz">AI</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/google_cloud/google-cloud-swagger-helloworld">Google Cloud</a></li><li class="menu__list-item"><a href="https://github.com/scottapp" target="_blank" rel="noopener noreferrer" class="menu__link">My GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Pytorch Tutorials</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">60 minutes Blitz</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz">60 minutes Blitz</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/1-tensor_tutorial">1-tensor_tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/2-autograd_tutorial">2-autograd_tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/3-neural_networks_tutorial">3-neural_networks_tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/4-cifar10_tutorial">4-cifar10_tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/docker-Deep-Learning-with-PyTorch-A-60-Minute-Blitz/5-data_parallel_tutorial">5-data_parallel_tutorial</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Pytorch Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial">Pytorch Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/201_torch_numpy">201 Torch and Numpy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/202_variable">202 Variable</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/203_activation">203 Activation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/301_regression">301 Regression</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/302_classification">302 Classification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/303_build_nn_quickly">303 Build NN Quickly</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/304_save_reload">304 Save and Reload</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/305_batch_train">305 Batch Train</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/306_optimizer">206 Optimizers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/401_CNN">401 CNN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/402_RNN">402 RNN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/403_RNN_regressor">403 RNN Regressor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/404_autoencoder">404 Autoencoder</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/405_DQN_Reinforcement_learning">405 DQN Reinforcement Learning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/406_GAN">406 GAN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/501_why_torch_dynamic_graph">501 Why Torch Dynamic Graph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/502_GPU">502 GPU</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/503_dropout">503 Dropout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai/Docker-PyTorch-Tutorial/504_batch_normalization">504 Batch Normalization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">What is Torch NN</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/What-is-Torch-nn">What is Torch NN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ai/What-is-Torch-nn/nn_tutorial">nn_tutorial</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">503 Dropout</h1></header><div class="markdown"><p>View more, visit my tutorial page: <a href="https://mofanpy.com/tutorials/" target="_blank" rel="noopener noreferrer">https://mofanpy.com/tutorials/</a>
My Youtube Channel: <a href="https://www.youtube.com/user/MorvanZhou" target="_blank" rel="noopener noreferrer">https://www.youtube.com/user/MorvanZhou</a></p><p>Dependencies:</p><ul><li>torch: 0.1.11</li><li>matplotlib</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torch</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">autograd </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Variable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pyplot </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> plt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain">matplotlib inline</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">manual_seed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reproducible</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;torch._C.Generator at 0x7f41f8033918&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">N_SAMPLES </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">N_HIDDEN </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">300</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># training data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">linspace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> N_SAMPLES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.3</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_SAMPLES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ones</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_SAMPLES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># test data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">linspace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> N_SAMPLES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> test_x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.3</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_SAMPLES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ones</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_SAMPLES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> volatile</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> volatile</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># show data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">scatter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;magenta&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> alpha</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;train&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">scatter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cyan&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> alpha</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;test&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">legend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">loc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;upper left&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ylim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="png" src="data:image/png;base64,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"></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">net_overfitting </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Linear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ReLU</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Linear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ReLU</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Linear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">net_dropped </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Linear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># drop 50% of the neuron</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ReLU</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Linear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dropout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># drop 50% of the neuron</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ReLU</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Linear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N_HIDDEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">net_overfitting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># net architecture</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">net_dropped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sequential (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (0): Linear (1 -&gt; 300)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (1): ReLU ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (2): Linear (300 -&gt; 300)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (3): ReLU ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (4): Linear (300 -&gt; 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sequential (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (0): Linear (1 -&gt; 300)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (1): Dropout (p = 0.5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (2): ReLU ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (3): Linear (300 -&gt; 300)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (4): Dropout (p = 0.5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (5): ReLU ()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  (6): Linear (300 -&gt; 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">optimizer_ofit </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">optim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">net_overfitting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">parameters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> lr</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">optimizer_drop </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">optim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">net_dropped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">parameters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> lr</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">loss_func </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MSELoss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-python codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> t </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">500</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pred_ofit </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> net_overfitting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pred_drop </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> net_dropped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    loss_ofit </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> loss_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">pred_ofit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    loss_drop </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> loss_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">pred_drop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    optimizer_ofit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">zero_grad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    optimizer_drop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">zero_grad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    loss_ofit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backward</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    loss_drop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backward</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    optimizer_ofit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">step</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    optimizer_drop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">step</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># change to eval mode in order to fix drop out effect</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        net_overfitting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        net_dropped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">eval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># parameters for dropout differ from train mode</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># plotting</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cla</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        test_pred_ofit </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> net_overfitting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        test_pred_drop </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> net_dropped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">scatter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;magenta&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> alpha</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;train&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">scatter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cyan&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> alpha</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;test&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_pred_ofit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;r-&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> lw</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;overfitting&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_pred_drop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;b--&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> lw</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dropout(50%)&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">text</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1.2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;overfitting loss=%.4f&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain"> loss_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_pred_ofit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fontdict</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;size&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;color&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;red&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">text</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dropout loss=%.4f&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain"> loss_func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">test_pred_drop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fontdict</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;size&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;color&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;blue&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">legend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">loc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;upper left&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ylim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pause</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># change back to train mode</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        net_overfitting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        net_dropped</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="png" src="/assets/images/503_dropout_8_0-2cdc61fbce390e1267889e99b6ae7636.png"></p><p><img alt="png" src="/assets/images/503_dropout_8_1-5494e7d48dd6cde1fc175c2840fd7100.png"></p><p><img alt="png" src="/assets/images/503_dropout_8_2-37f1cc8b1bb557d504c0aa1a8262e849.png"></p><p><img alt="png" src="/assets/images/503_dropout_8_3-1b8d262224d00e938033da87cb01a48b.png"></p><p><img alt="png" src="/assets/images/503_dropout_8_4-13f00b01ee49d6ac43e62bf107533526.png"></p><div class="mdxCodeBlock_1zKU"><code class="language-python"></code></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ai/Docker-PyTorch-Tutorial/502_GPU"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 502 GPU</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ai/Docker-PyTorch-Tutorial/504_batch_normalization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">504 Batch Normalization Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/scottapp" target="_blank" rel="noopener noreferrer" class="footer__link-item">My Github</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.17a13f5e.js"></script>
<script src="/runtime~main.a6e9567d.js"></script>
<script src="/main.f1fc0924.js"></script>
<script src="/1.d92934f8.js"></script>
<script src="/58.88e27d8d.js"></script>
<script src="/59.9c53c36f.js"></script>
<script src="/935f2afb.bed38aba.js"></script>
<script src="/57.7e63f0fc.js"></script>
<script src="/bea0d63e.7aa2a360.js"></script>
</body>
</html>